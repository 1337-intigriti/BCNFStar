<div sbbDialogTitle>Metanome configuration settings</div>
<div sbbDialogContent>
  <form class="sbb-form-group-vertical" [formGroup]="formGroup">
    <h2>Functional Dependencies</h2>
    <div *ngFor="let table of tables; let index = index">
      {{ table.schemaAndName() }}
      <sbb-toggle
        [formControl]="selectedFdTab[index]"
        (change)="onFdToggleBarChange($event, table)"
      >
        <sbb-toggle-option label="Use existing result" value="existing-result">
          <sbb-toggle-details>
            <sbb-select [formControlName]="'fds_' + table.schemaAndName()">
              <sbb-option
                *ngFor="let result of filteredMetanomeResultsForFd(table)"
                [value]="result"
              >
                {{ metanomeConfigInfo(result) }}
              </sbb-option>
            </sbb-select>
          </sbb-toggle-details>
        </sbb-toggle-option>
        <sbb-toggle-option label="HyFD" value="hyfd">
          <sbb-toggle-details>
            <sbb-select
              [formControlName]="'fds_' + table.schemaAndName()"
              [value]="hyfdConfigs['fds_' + table.schemaAndName()]"
              class="display-non"
            >
              <sbb-option [value]="hyfdConfigs['fds_' + table.schemaAndName()]">
                {{ hyfdConfigs["fds_" + table.schemaAndName()] }}
              </sbb-option>
            </sbb-select>
            <div
              *ngFor="
                let entry of hyfdConfigs['fds_' + table.schemaAndName()][
                  'config'
                ] | keyvalue
              "
            >
              <sbb-checkbox
                *ngIf="isBoolean(entry.value)"
                [(ngModel)]="
                  hyfdConfigs['fds_' + table.schemaAndName()]['config'][
                    entry.key
                  ]
                "
                [ngModelOptions]="{ standalone: true }"
              >
                {{ entry.key }}
              </sbb-checkbox>
              <div *ngIf="!isBoolean(entry.value)">
                <sbb-label>{{ entry.key }}</sbb-label>
                <input
                  sbbInput
                  [(ngModel)]="
                    hyfdConfigs['fds_' + table.schemaAndName()]['config'][
                      entry.key
                    ]
                  "
                  [ngModelOptions]="{ standalone: true }"
                />
              </div>
            </div>
          </sbb-toggle-details>
        </sbb-toggle-option>
      </sbb-toggle>
    </div>
    <h2>Inclusion Dependencies</h2>
    {{ getAllTableNames() }}
    <sbb-toggle
      [formControl]="selectedIndTab"
      (change)="onIndToggleBarChange($event)"
    >
      <sbb-toggle-option label="Use existing result" value="existing-result">
        <sbb-toggle-details>
          <sbb-select formControlName="ind">
            <sbb-option
              *ngFor="let result of filteredMetanomeResultsForInd()"
              [value]="result"
            >
              {{ metanomeConfigInfo(result) }}
            </sbb-option>
          </sbb-select>
        </sbb-toggle-details>
      </sbb-toggle-option>
      <sbb-toggle-option label="Binder" value="binder">
        <sbb-toggle-details>
          <sbb-select
            [value]="binderConfigs['ind']"
            formControlName="ind"
            class="display-non"
          >
            <sbb-option [value]="binderConfigs['ind']">
              {{ binderConfigs["ind"] }}
            </sbb-option>
          </sbb-select>
          <div *ngFor="let entry of binderConfigs['ind']['config'] | keyvalue">
            <sbb-checkbox
              *ngIf="isBoolean(entry.value)"
              [(ngModel)]="binderConfigs['ind']['config'][entry.key]"
              [ngModelOptions]="{ standalone: true }"
            >
              {{ entry.key }}
            </sbb-checkbox>
            <div *ngIf="!isBoolean(entry.value)">
              <sbb-label>{{ entry.key }}</sbb-label>
              <input
                sbbInput
                [(ngModel)]="binderConfigs['ind']['config'][entry.key]"
                [ngModelOptions]="{ standalone: true }"
              />
            </div>
          </div>
        </sbb-toggle-details>
      </sbb-toggle-option>
      <sbb-toggle-option label="FAIDA" value="faida">
        <sbb-toggle-details>
          <sbb-select
            [value]="faidaConfigs['ind']"
            formControlName="ind"
            class="display-non"
          >
            <sbb-option [value]="faidaConfigs['ind']">
              {{ faidaConfigs["ind"] }}
            </sbb-option>
          </sbb-select>
          <div *ngFor="let entry of faidaConfigs['ind']['config'] | keyvalue">
            <sbb-checkbox
              *ngIf="isBoolean(entry.value)"
              [(ngModel)]="faidaConfigs['ind']['config'][entry.key]"
              [ngModelOptions]="{ standalone: true }"
            >
              {{ entry.key }}
            </sbb-checkbox>
            <div *ngIf="!isBoolean(entry.value)">
              <sbb-label>{{ entry.key }}</sbb-label>
              <input
                sbbInput
                [(ngModel)]="faidaConfigs['ind']['config'][entry.key]"
                [ngModelOptions]="{ standalone: true }"
              />
            </div>
          </div>
        </sbb-toggle-details>
      </sbb-toggle-option>
    </sbb-toggle>
  </form>
</div>
<div sbbDialogActions>
  <button (click)="runMetoname()" sbb-button cdkFocusInitial>Ok</button>
  <button sbb-secondary-button sbbDialogClose>Cancel</button>
</div>
